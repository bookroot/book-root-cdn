var historyObject={position:0,limit:10,finishLoad:!1,Init:function(){var rule=template.defaults.rules[0];rule.test=new RegExp(rule.test.source.replace("<%","\\[\\?").replace("%>","\\?]")),window.onscroll=function(){historyObject.scrollFunction();var bottom=common.getScrollHeight()-(common.getScrollTop()+common.getWindowHeight());if(bottom<=200){if(historyObject.finishLoad===!0){common.loadClose();return}historyObject.loadList()}},this.loadList()},loadList:function(){common.loadShow(),common.noneNoMore();var url=common.baseUrl+"/api/v3/topic/history";$.ajax({type:"Get",url,data:{user_uuid:localStorage.getItem("user_uuid"),limit:historyObject.limit,position:historyObject.position},success:function(result){if(result.code==50001){window.location.href="/login";return}if(result.code!=200){common.showHint("warning","加载失败"),common.loadClose();return}if(!result.data.data){common.blockNoMore(),historyObject.finishLoad=!0,common.loadClose();return}var html=template("history-template",{data:result.data.data});historyObject.position=result.data.position,$("#history-list").append(html),common.loadClose()},error:function(){common.showHint("warning","网络错误"),common.loadClose()}})},scrollFunction:function(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}}