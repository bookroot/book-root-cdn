var MessageObject={position:0,limit:10,finishLoad:!1,Init:function(){var rule=template.defaults.rules[0];rule.test=new RegExp(rule.test.source.replace("<%","\\[\\?").replace("%>","\\?]")),window.onscroll=function(){MessageObject.scrollFunction();var bottom=common.getScrollHeight()-(common.getScrollTop()+common.getWindowHeight());if(bottom<=200){if(MessageObject.finishLoad===!0){common.loadClose();return}MessageObject.loadList()}},this.loadList()},loadList:function(){common.noneNoMore(),common.loadShow();var url=common.baseUrl+"/api/v1/user/message_list";$.ajax({type:"Get",url,data:{user_uuid:localStorage.getItem("user_uuid"),limit:MessageObject.limit,position:MessageObject.position},success:function(result){if(result.code==50001){window.location.href="/login";return}if(result.code!=200){common.showHint("warning","加载失败"),common.loadClose();return}if(!result.data.data){common.blockNoMore(),MessageObject.finishLoad=!0,common.loadClose();return}var html=template("message-template",{data:result.data.data});MessageObject.position=result.data.position,$("#message-list").append(html),common.loadClose()},error:function(){common.loadClose()}})},scrollFunction:function(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"},open:function(content){$("#content").text(content),$("#messageModal").modal()}}